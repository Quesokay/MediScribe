╔═══════════════════════════════════════════════════════════════════════════════╗
║                    MEDISCRIBE - CHATGPT VOICE MODE WORKFLOW                   ║
╚═══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│                           STEP 1: CONVERSATION                              │
└─────────────────────────────────────────────────────────────────────────────┘

    👨‍⚕️ Doctor                          👤 Patient
       │                                  │
       │  "What brings you in today?"    │
       │─────────────────────────────────>│
       │                                  │
       │  "I have fever and headache"    │
       │<─────────────────────────────────│
       │                                  │
       │  "Let me check your vitals..."  │
       │─────────────────────────────────>│
       │                                  │
                        ↓
            ┌───────────────────────┐
            │   ChatGPT Voice Mode  │
            │  Records & Transcribes│
            └───────────────────────┘
                        ↓

┌─────────────────────────────────────────────────────────────────────────────┐
│                        STEP 2: COPY TRANSCRIPT                              │
└─────────────────────────────────────────────────────────────────────────────┘

    ┌─────────────────────────────────────────────────────────┐
    │  Doctor: What brings you in today?                      │
    │  Patient: I'm John Doe, 45 years old. I have fever     │
    │           and headache for 3 days.                      │
    │  Doctor: Let me check. Temperature is 101.5F.           │
    │          I'll prescribe Ibuprofen 400mg.                │
    └─────────────────────────────────────────────────────────┘
                        ↓
                   [Ctrl+C Copy]
                        ↓

┌─────────────────────────────────────────────────────────────────────────────┐
│                    STEP 3: PASTE INTO MEDISCRIBE                            │
└─────────────────────────────────────────────────────────────────────────────┘

    $ python realtime_chatgpt_processor.py
    
    ┌─────────────────────────────────────────────────────────┐
    │  MENU                                                   │
    │  1. Process conversation (paste mode)                   │
    │  2. Process from file                                   │
    │  3. View recent records                                 │
    │  4. Test with sample conversation                       │
    │  5. Exit                                                │
    └─────────────────────────────────────────────────────────┘
    
    Select option: 1
    
    Paste conversation here:
    [User pastes transcript]
    [Ctrl+Z + Enter]
                        ↓

┌─────────────────────────────────────────────────────────────────────────────┐
│                    STEP 4: PROCESSING PIPELINE                              │
└─────────────────────────────────────────────────────────────────────────────┘

    ┌──────────────────────────────────────────────────────────────┐
    │  🔍 LANGUAGE DETECTION                                       │
    │  ─────────────────────────────────────────────────────────── │
    │  Analyzing text...                                           │
    │  Keywords: "doctor", "patient", "fever"                      │
    │  ✓ Detected: English                                         │
    └──────────────────────────────────────────────────────────────┘
                        ↓
    ┌──────────────────────────────────────────────────────────────┐
    │  🌐 TRANSLATION (if needed)                                  │
    │  ─────────────────────────────────────────────────────────── │
    │  Source: English                                             │
    │  Target: English                                             │
    │  ✓ Already in English - skipping translation                │
    └──────────────────────────────────────────────────────────────┘
                        ↓
    ┌──────────────────────────────────────────────────────────────┐
    │  🔬 MEDICAL ENTITY EXTRACTION                                │
    │  ─────────────────────────────────────────────────────────── │
    │  Using spaCy NLP...                                          │
    │  ✓ Found patient: John Doe                                   │
    │  ✓ Found age: 45                                             │
    │  ✓ Found symptoms: fever, headache                           │
    │  ✓ Found vital signs: temperature 101.5F                     │
    │  ✓ Found medications: Ibuprofen 400mg                        │
    └──────────────────────────────────────────────────────────────┘
                        ↓
    ┌──────────────────────────────────────────────────────────────┐
    │  💾 DATABASE STORAGE                                         │
    │  ─────────────────────────────────────────────────────────── │
    │  Creating record...                                          │
    │  Record ID: REC-20251024103000                               │
    │  ✓ Saved to database                                         │
    └──────────────────────────────────────────────────────────────┘
                        ↓

┌─────────────────────────────────────────────────────────────────────────────┐
│                        STEP 5: STRUCTURED OUTPUT                            │
└─────────────────────────────────────────────────────────────────────────────┘

    ╔═══════════════════════════════════════════════════════════════╗
    ║                  📊 EXTRACTED DATA SUMMARY                    ║
    ╠═══════════════════════════════════════════════════════════════╣
    ║  👤 Patient: John Doe                                         ║
    ║  📅 Age: 45                                                   ║
    ║  ⚧  Gender: male                                              ║
    ║                                                               ║
    ║  🤒 Symptoms (2):                                             ║
    ║     • fever                                                   ║
    ║     • headache                                                ║
    ║                                                               ║
    ║  📈 Vital Signs (1):                                          ║
    ║     • temperature 101.5F                                      ║
    ║                                                               ║
    ║  💊 Medications (1):                                          ║
    ║     • Ibuprofen 400mg                                         ║
    ║                                                               ║
    ║  🆔 Record ID: REC-20251024103000                             ║
    ╚═══════════════════════════════════════════════════════════════╝


═══════════════════════════════════════════════════════════════════════════════
                          MULTILINGUAL WORKFLOW
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│                    SHONA CONVERSATION EXAMPLE                               │
└─────────────────────────────────────────────────────────────────────────────┘

    Original (Shona):
    ┌─────────────────────────────────────────────────────────┐
    │  Chiremba: Zita renyu ndiani?                           │
    │  Murwere: Ndini John Doe, ndine makore 45.              │
    │            Ndine fivha uye kurwara musoro.              │
    │  Chiremba: Tembiricha yenyu iri pa 38.5 degrees.        │
    │            Ndichakupai Paracetamol 500mg.               │
    └─────────────────────────────────────────────────────────┘
                        ↓
    ┌──────────────────────────────────────────────────────────────┐
    │  🔍 LANGUAGE DETECTION                                       │
    │  ─────────────────────────────────────────────────────────── │
    │  Keywords: "chiremba", "murwere", "ndine"                    │
    │  ✓ Detected: Shona                                           │
    └──────────────────────────────────────────────────────────────┘
                        ↓
    ┌──────────────────────────────────────────────────────────────┐
    │  🌐 TRANSLATION (NLLB-200)                                   │
    │  ─────────────────────────────────────────────────────────── │
    │  Source: Shona (sna_Latn)                                    │
    │  Target: English (eng_Latn)                                  │
    │  Model: facebook/nllb-200-distilled-600M                     │
    │  ✓ Translation complete                                      │
    └──────────────────────────────────────────────────────────────┘
                        ↓
    Translated (English):
    ┌─────────────────────────────────────────────────────────┐
    │  Doctor: What is your name?                             │
    │  Patient: I am John Doe, I am 45 years old.             │
    │           I have fever and headache.                    │
    │  Doctor: Your temperature is 38.5 degrees.              │
    │          I will give you Paracetamol 500mg.             │
    └─────────────────────────────────────────────────────────┘
                        ↓
    [Same extraction process as English workflow]
                        ↓
    ╔═══════════════════════════════════════════════════════════════╗
    ║  Output includes:                                             ║
    ║  • original_language: "shona"                                 ║
    ║  • original_text: [Shona conversation]                        ║
    ║  • translated_text: [English translation]                     ║
    ║  • All extracted entities from English translation            ║
    ╚═══════════════════════════════════════════════════════════════╝


═══════════════════════════════════════════════════════════════════════════════
                            MCP INTEGRATION WORKFLOW
═══════════════════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────────────────┐
│                        STEP 1: START MCP SERVER                             │
└─────────────────────────────────────────────────────────────────────────────┘

    $ python mcp_server.py
    
    ┌──────────────────────────────────────────────────────────────┐
    │  MediScribe MCP Server                                       │
    │  Listening for tool calls...                                 │
    │  Available tools:                                            │
    │    • extract_medical_data                                    │
    │    • translate_and_extract                                   │
    │    • search_patient_records                                  │
    │    • get_patient_record                                      │
    │    • get_all_records                                         │
    │    • save_to_database                                        │
    └──────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                    STEP 2: CHATGPT CALLS MCP TOOL                           │
└─────────────────────────────────────────────────────────────────────────────┘

    User in ChatGPT:
    ┌─────────────────────────────────────────────────────────┐
    │  "Extract medical data from this conversation:          │
    │   Patient John Doe, 45, has fever and headache.         │
    │   Temperature 101.5F. Prescribed Ibuprofen 400mg."      │
    └─────────────────────────────────────────────────────────┘
                        ↓
    ChatGPT (MCP Client):
    ┌─────────────────────────────────────────────────────────┐
    │  Calling tool: extract_medical_data                     │
    │  Arguments: {                                           │
    │    "transcription": "Patient John Doe, 45...",          │
    │    "save_to_db": true                                   │
    │  }                                                      │
    └─────────────────────────────────────────────────────────┘
                        ↓
    MCP Server:
    ┌──────────────────────────────────────────────────────────────┐
    │  Received tool call: extract_medical_data                    │
    │  Processing...                                               │
    │  ✓ Extraction complete                                       │
    │  ✓ Saved to database: REC-20251024103000                     │
    │  Returning results...                                        │
    └──────────────────────────────────────────────────────────────┘
                        ↓
    ChatGPT Response:
    ┌─────────────────────────────────────────────────────────┐
    │  I've extracted the medical data:                       │
    │                                                         │
    │  Patient: John Doe, 45 years old                        │
    │  Symptoms: fever, headache                              │
    │  Vital Signs: temperature 101.5F                        │
    │  Medications: Ibuprofen 400mg                           │
    │                                                         │
    │  Saved as record: REC-20251024103000                    │
    └─────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                              DATA FLOW DIAGRAM
═══════════════════════════════════════════════════════════════════════════════

    ┌─────────────┐
    │  ChatGPT    │  Voice conversation
    │ Voice Mode  │  ↓
    └──────┬──────┘  Text transcript
           │
           ↓ User copies
    ┌─────────────┐
    │   User      │  Paste into MediScribe
    │  Clipboard  │  ↓
    └──────┬──────┘
           │
           ↓
    ┌──────────────────────────────────────────────────────────┐
    │  MediScribe Processing Pipeline                          │
    │                                                          │
    │  ┌────────────────┐    ┌────────────────┐              │
    │  │   Language     │───>│  Translation   │              │
    │  │   Detection    │    │   (NLLB-200)   │              │
    │  └────────────────┘    └────────┬───────┘              │
    │                                  │                       │
    │                                  ↓                       │
    │                         ┌────────────────┐              │
    │                         │    Medical     │              │
    │                         │   Extraction   │              │
    │                         │    (spaCy)     │              │
    │                         └────────┬───────┘              │
    │                                  │                       │
    │                                  ↓                       │
    │                         ┌────────────────┐              │
    │                         │    Database    │              │
    │                         │    Storage     │              │
    │                         │   (SQLite)     │              │
    │                         └────────┬───────┘              │
    └──────────────────────────────────┼──────────────────────┘
                                       │
                                       ↓
                              ┌────────────────┐
                              │  Structured    │
                              │     Data       │
                              │   + Record ID  │
                              └────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                            SUPPORTED LANGUAGES
═══════════════════════════════════════════════════════════════════════════════

    ┌─────────────┬──────────┬─────────────────────────────────────┐
    │  Language   │   Code   │           Region                    │
    ├─────────────┼──────────┼─────────────────────────────────────┤
    │  English    │   en     │  Default                            │
    │  Shona      │   sn     │  Zimbabwe                           │
    │  Ndebele    │   nd     │  Zimbabwe / South Africa            │
    │  Zulu       │   zu     │  South Africa                       │
    │  Xhosa      │   xh     │  South Africa                       │
    │  Afrikaans  │   af     │  South Africa                       │
    └─────────────┴──────────┴─────────────────────────────────────┘

    All languages → English → Medical Entity Extraction


═══════════════════════════════════════════════════════════════════════════════
                          EXTRACTED ENTITY TYPES
═══════════════════════════════════════════════════════════════════════════════

    ┌────────────────────────────────────────────────────────────────┐
    │  👤 PATIENT INFORMATION                                        │
    │     • Name                                                     │
    │     • Age                                                      │
    │     • Gender                                                   │
    ├────────────────────────────────────────────────────────────────┤
    │  🤒 CLINICAL FINDINGS                                          │
    │     • Symptoms (complaints, pain, discomfort)                  │
    │     • Diagnosis (conditions, diseases)                         │
    │     • Vital Signs (temperature, BP, heart rate)                │
    │     • Allergies                                                │
    ├────────────────────────────────────────────────────────────────┤
    │  💊 TREATMENT                                                  │
    │     • Medications (drug names)                                 │
    │     • Dosages (amounts, frequency)                             │
    │     • Treatment Plan (instructions)                            │
    │     • Follow-up (next steps)                                   │
    └────────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                              END OF WORKFLOW
═══════════════════════════════════════════════════════════════════════════════
